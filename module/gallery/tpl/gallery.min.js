window.addEventListener("load",()=>{let e=[];document.querySelector("#galleryList .list-group").querySelectorAll("img")?.forEach((t,r)=>{e[r]='<div class="carousel-item" item-key="%s"><h6></h6><img src="%s" class="d-block w-100" alt="" loading="lazy"></div>'.sprintf(t.src.getQuery("file"),"./common/img/blank.png")});let t=document.querySelector("#galleryContentModal .carousel-inner");t.innerHTML=e.join("");let r=(e,r)=>{let l=t.querySelector('.carousel-item[item-key="'+r+'"]');exec_ajax({module:"gallery",act:"getFiles",md_id:e,mf_srls:r}).then(e=>{e.forEach(e=>{let t=l.querySelector("img");t.src="./?file="+e.mf_srl,t.setAttribute("alt",e.mf_name),l.querySelector("h6").innerHTML=(e.mf_name||"")+", "+(e.mf_regdate||"")})}).catch(e=>{console.log(e),l.querySelector("h6").innerHTML=e})},l=current_url.getQuery("id");document.querySelector("#galleryContentModal")?.addEventListener("show.bs.modal",e=>{let i=e.relatedTarget.querySelector("img")?.src.getQuery("file");t.querySelectorAll(".carousel-item.active")?.forEach(e=>{e.classList.remove("active")}),t.querySelector('.carousel-item[item-key="'+i+'"]').classList.add("active"),r(l,i)}),document.getElementById("carouselGallery")?.addEventListener("slide.bs.carousel",function(e){if(0==e.from&&"right"==e.direction||0==e.to&&"left"==e.direction){e.preventDefault(),e.stopPropagation();let t=document.getElementById("paginationGallery").querySelectorAll("li.page-number");confirm($_LANG["confirm_page_"+e.direction]).then(()=>{t.forEach((r,l)=>{if(r.hasAttribute("selected")){t["left"==e.direction?l+1:l-1]?.querySelector("a").click();return}})}).catch(e=>console.log(e))}else r(l,e.relatedTarget.getAttribute("item-key"))})});