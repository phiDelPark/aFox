!function(e){"use strict";var t='<form action="%s" class="input-password" method="post" autocomplete="off"><div class="form-inline"><div>%s</div><input class="form-control" name="mb_password" type="password" placeholder="%s" style="width:150px" required> <button class="btn btn-primary" type="submit">%s</button> <button class="btn btn-default" type="button">%s</button></div></form>';e("[data-exec-act]").click(function(){var r={},a=e(this),s=a.attr("data-exec-act"),n=a.attr("data-act-param");if(!n)return!1;for(var o=0,i=(n=n.split(",")).length;o<i;o+=2)r[n[o]]=n[o+1];var d=a.closest("#bdReply"),c=a.closest(".reply-item"),p=a.attr("data-act-password")||"";d.find("form.right").remove().end().find(".reply-item>.right").show();var u=d.find('[data-exec-ajax="board.updateComment"]').clone().hide(),l=u.find(".af_editor_rp_content").afEditor();u.find(".form-group").show(),u.find('[disabled="disabled"]').removeAttr("disabled");var f=function(t,r,a){if("success"==t){e('<input type="hidden" name="rp_srl" value="">').prependTo(u);var s=c.find(">.right");return"0"===r.mb_srl&&(u.find(".area-mbinfo").find('[name="mb_nick"],[name="mb_password"]').attr("required","required").end().removeClass("hide"),u.find(".af-editor-toolbar,.af-editor-content>textarea,.af-editor-content>iframe").removeAttr("readonly")),u[0].dataImport(r),u.addClass("right").find(".close").show().click(function(){s.show("fast",function(){u.remove()})}).end().insertAfter(s.hide("slow")).show("slow"),u.find(".btn-success").removeClass("btn-success").addClass("btn-info"),2==r.rp_type&&l.switch(!0),c[0].scrollIntoView(!0),!1}};if("board.deleteComment"==s||"board.getComment"==s&&p){var m,_=encodeURIComponent(current_url.setQuery("rp",""));if(c.find(">>.inside_massage_box").length>0)return!1;p?"board.getComment"==s?(m=e(t.sprintf("",$_LANG.request_input.sprintf($_LANG.password),$_LANG.password,$_LANG.ok,$_LANG.close))).on("success.exec.ajax",function(t,r,a){t.preventDefault(),f("success",r),e(this).remove()}):m=e(t.sprintf("",$_LANG.confirm_select_delete.sprintf($_LANG.comment),$_LANG.password,$_LANG.ok,$_LANG.close)):m=e('<form action="%s" class="input-group" method="post" autocomplete="off"><div><div>%s</div><button class="btn btn-primary" type="submit">%s</button> <button class="btn btn-default" type="button">%s</button></div></form>'.sprintf("",$_LANG.confirm_select_delete.sprintf($_LANG.comment),$_LANG.yes,$_LANG.no)),m.on("error.exec.ajax",function(t,r,a){t.preventDefault(),e(t.currentTarget).find(">div>div").css("color","red").html($_LANG.error+": "+r),e(t.currentTarget).find('[name="mb_password"]').val("").focus()}).hide().addClass("inside_massage_box").prependTo(c.find(">.right")).fadeIn("slow"),m.find("button.btn-default").click(function(){m.fadeOut("slow",function(){e(this).remove()})}).focus(),m.attr("data-exec-ajax",s),m.prepend('<input type="hidden" name="rp_srl" value="'+r.rp_srl+'">'),m.prepend('<input type="hidden" name="success_return_url" value="'+_+'">'),m.addClass("inside_massage_box").prependTo(c.find(">.right")).fadeIn("slow",function(){var t=e(this).find('[name="mb_password"]');t.length>0&&t.focus()})}else"board.getComment"!=s&&"board.updateComment"!=s||("board.getComment"==s?exec_ajax(s,r,f):(l.switch(!1),e('<input type="hidden" name="rp_parent" value="">').prependTo(u),u[0].dataImport({rp_type:1,rp_secret:0,rp_content:"",rp_parent:r.rp_parent}),u.addClass("right").insertAfter(c.find(">.right")).show("slow")));return u.on("success.exec.ajax",function(e,t,r){e.preventDefault(),t.redirect_url&&parent.location.replace(t.redirect_url.setQuery("rp",t.rp_srl))}),!1}),e('[data-exec-ajax="board.updateDocument"],[data-exec-ajax="board.updateComment"]').on("success.exec.ajax",function(t,r,a){t.preventDefault();var s="board.updateDocument"==e(this).attr("data-exec-ajax");r.redirect_url&&parent.location.replace(r.redirect_url.setQuery(s?"srl":"rp",r[s?"wr_srl":"rp_srl"]))}),e(document).on("change.af.editor.toolbar",".af-editor-toolbar",function(t,r,a,s){var n=e(this).closest(".af-editor-group");"wr_type"!=r&&"rp_type"!=r||1!=n.length||n.data("af.editor").switch("2"===s)}),e('.list-table tr[data-hot-track], [href="#requirePassword"]').click(function(){var t=e(this);"TR"==t[0].tagName&&(t=t.find(".wr_title a"));var r=t.attr("href");if("#requirePassword"==r&&t.attr("data-param")){msg_box('<form action="%s" method="post" autocomplete="off"><p>%s</p><div class="form-group"><input type="password" class="form-control" name="mb_password" placeholder="%s" required /> <span class="sr-only">%s</span></div></form>'.sprintf(current_url,$_LANG.request_input.sprintf($_LANG.password),$_LANG.password,$_LANG.password),null,["question",["OK","cancel"]],function(e,r){if("ok"!=e)return!0;var a=r.find("form"),s=t.attr("data-srl")||"",n=(t.attr("data-param")||"").split(","),o=current_url;return s&&n.length>1&&(o=o.setQuery(n),a.off("submit"),a.on("submit",function(){if(a.data("check success"))return!0;var e={},t=["wr_srl"];return e.wr_srl=s,e.mb_password=a.find('input[name="mb_password"]').val(),exec_ajax("board.checkpassword",e,function(e,t,r){return a.data("check success","success"===e),"success"===e?(a.submit(),!1):"error"===e?(a.find(">p").html($_LANG.error+": "+t).css("color","red"),a.find('input[name="mb_password"]').val("").focus(),!1):void 0},t),!1}).attr("action",o).submit()),!1})}else location.href=r;return!1}),e(window).on("load",function(){var t=e("a.active[id^=reply_]")[0];t&&t.scrollIntoView(!0)})}(jQuery);