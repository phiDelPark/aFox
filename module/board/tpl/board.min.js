!function(e){"use strict";var t='<form action="%s" class="input-password" method="post" autocomplete="off"><div class="form-inline"><div>%s</div><input class="form-control" name="mb_password" type="password" placeholder="%s" style="width:150px" required> <button class="btn btn-primary" type="submit">%s</button> <button class="btn btn-default" type="button">%s</button></div></form>';e("[data-exec-act]").click(function(){var r={},a=e(this),o=a.attr("data-exec-act"),n=a.attr("data-act-param");if(!n)return!1;for(var s=0,d=(n=n.split(",")).length;s<d;s+=2)r[n[s]]=n[s+1];var i=a.closest("#bdReply"),c=a.closest(".reply-item"),l=a.attr("data-act-password")||"";i.find("form.right").remove().end().find(".reply-item>.right").show();var p=i.find('[data-exec-ajax="board.updateComment"]').clone().hide(),u=p.find(".af_editor_rp_content").afEditor();p.find(".form-group").show(),p.find('[disabled="disabled"]').removeAttr("disabled");var f=function(t,r,a){if("success"==t){e('<input type="hidden" name="rp_srl" value="">').prependTo(p);var o=c.find(">.right");return"0"===r.mb_srl&&(p.find(".area-mbinfo").find('[name="mb_nick"],[name="mb_password"]').attr("required","required").end().removeClass("hide"),p.find(".af-editor-toolbar,.af-editor-content>textarea,.af-editor-content>iframe").removeAttr("readonly")),p[0].dataImport(r),p.addClass("right").find(".close").show().click(function(){o.show("fast",function(){p.remove()})}).end().insertAfter(o.hide("slow")).show("slow"),p.find(".btn-success").removeClass("btn-success").addClass("btn-info"),2==r.rp_type&&u.switch(!0),c[0].scrollIntoView(!0),!1}};if("board.deleteComment"==o||"board.getComment"==o&&l){var m,_=encodeURIComponent(current_url.setQuery("rp",""));if(c.find(">>.inside_massage_box").length>0)return!1;l?"board.getComment"==o?(m=e(t.sprintf("",$_LANG.request_input.sprintf($_LANG.password),$_LANG.password,$_LANG.ok,$_LANG.close))).on("success.exec.ajax",function(t,r,a){t.preventDefault(),f("success",r),e(this).remove()}):m=e(t.sprintf("",$_LANG.confirm_select_delete.sprintf($_LANG.comment),$_LANG.password,$_LANG.ok,$_LANG.close)):m=e('<form action="%s" class="input-group" method="post" autocomplete="off"><div><div>%s</div><button class="btn btn-primary" type="submit">%s</button> <button class="btn btn-default" type="button">%s</button></div></form>'.sprintf("",$_LANG.confirm_select_delete.sprintf($_LANG.comment),$_LANG.yes,$_LANG.no)),m.on("error.exec.ajax",function(t,r,a){t.preventDefault(),e(t.currentTarget).find(">div>div").css("color","red").html($_LANG.error+": "+r)}).hide().addClass("inside_massage_box").prependTo(c.find(">.right")).fadeIn("slow"),m.find("button.btn-default").click(function(){m.fadeOut("slow",function(){e(this).remove()})}).focus(),m.attr("data-exec-ajax",o),m.prepend('<input type="hidden" name="rp_srl" value="'+r.rp_srl+'">'),m.prepend('<input type="hidden" name="success_return_url" value="'+_+'">'),m.addClass("inside_massage_box").prependTo(c.find(">.right")).fadeIn("slow",function(){var t=e(this).find('[name="mb_password"]');t.length>0&&t.focus()})}else"board.getComment"!=o&&"board.updateComment"!=o||("board.getComment"==o?exec_ajax(o,r,f):(u.switch(!1),e('<input type="hidden" name="rp_parent" value="">').prependTo(p),p[0].dataImport({rp_type:1,rp_secret:0,rp_content:"",rp_parent:r.rp_parent}),p.addClass("right").insertAfter(c.find(">.right")).show("slow")));return p.on("success.exec.ajax",function(e,t,r){e.preventDefault(),t.redirect_url&&parent.location.replace(t.redirect_url.setQuery("rp",t.rp_srl))}),!1}),e('[data-exec-ajax="board.updateDocument"],[data-exec-ajax="board.updateComment"]').on("success.exec.ajax",function(t,r,a){t.preventDefault();var o="board.updateDocument"==e(this).attr("data-exec-ajax");r.redirect_url&&parent.location.replace(r.redirect_url.setQuery(o?"srl":"rp",r[o?"wr_srl":"rp_srl"]))}),e(document).on("change.af.editor.toolbar",".af-editor-toolbar",function(t,r,a,o){var n=e(this).closest(".af-editor-group");"wr_type"!=r&&"rp_type"!=r||1!=n.length||n.data("af.editor").switch("2"===o)}),e(".list-table tr[data-hot-track]").click(function(){var t=e(".wr_title a",this),r=t.attr("href");return"#"==r&&"#passwordBoxModal"==t.attr("data-target")?e(t.attr("data-target")).modal("show",t):location.href=r,!1}),e("#passwordBoxModal","#bdList").on("show.bs.modal",function(t){if(void 0===t.relatedTarget)return t.preventDefault(),!1;var r=e(this),a=r.find("form"),o=e(t.relatedTarget),n=o.attr("data-srl")||"",s=(o.attr("data-param")||"").split(","),d=current_url;a.find(".modal-body>p.error").remove().end().find(".modal-body>p").show().end().find('input[name="mb_password"]').val(""),n&&s.length>1&&(d=d.setQuery(s),a.on("submit",function(){if(a.data("check success"))return!0;var t={},o=["mb_password"];return t.wr_srl=n,t.mb_password=r.find('input[name="mb_password"]').val(),exec_ajax("board.checkpassword",t,function(t,r,o){if(a.data("check success","success"===t),"success"===t)return a.submit(),!1;if("error"===t){var n=a.find(".modal-body>p.error");return 0===n.length&&(n=e('<p class="error" style="color:red">'),a.find(".modal-body>p").hide().after(n)),n.html($_LANG.error+": "+r),!1}},o),!1}).attr("action",d))}).on("shown.bs.modal",function(t){e(this).find('[name="mb_password"]').focus()}),e(window).on("load",function(){var t=e("a.active[id^=reply_]")[0];t&&t.scrollIntoView(!0)})}(jQuery);