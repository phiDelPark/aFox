(()=>{"use strict";const e=()=>localStorage.getItem("theme"),t=()=>{const t=e();return t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")},r=e=>{"auto"===e&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.setAttribute("data-bs-theme","dark"):document.documentElement.setAttribute("data-bs-theme",e)};r(t());const c=(e,t=!1)=>{const r=document.querySelector("#bd-theme");if(!r)return;const c=document.querySelector("#bd-theme-text"),o=document.querySelector(".theme-icon-active use"),a=document.querySelector(`[data-bs-theme-value="${e}"]`),n=a.querySelector("svg use").getAttribute("href");document.querySelectorAll("[data-bs-theme-value]").forEach((e=>{e.classList.remove("active"),e.setAttribute("aria-pressed","false")})),a.classList.add("active"),a.setAttribute("aria-pressed","true"),o.setAttribute("href",n);const s=`${c.textContent} (${a.dataset.bsThemeValue})`;r.setAttribute("aria-label",s),t&&r.focus()};window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(()=>{const c=e();"light"!==c&&"dark"!==c&&r(t())})),window.addEventListener("DOMContentLoaded",(()=>{c(t()),document.querySelectorAll("[data-bs-theme-value]").forEach((e=>{e.addEventListener("click",(()=>{const t=e.getAttribute("data-bs-theme-value");(e=>{localStorage.setItem("theme",e)})(t),r(t),c(t,!0)}))})),window.current_content=document.querySelector(".current_content"),window.current_content?.querySelectorAll("img[src]")?.forEach((e=>{const t=e.getAttribute("src");e.setAttribute("src","./common/img/blank.png"),e.setAttribute("scroll-src",t)}))})),window.addEventListener("scroll",(()=>{window.current_content?.querySelectorAll("img[scroll-src]")?.forEach((e=>{if(e.offsetTop<window.scrollY+window.innerHeight+50){const t=e.getAttribute("scroll-src");e.setAttribute("src",t),e.removeAttribute("scroll-src")}}))})),window.addEventListener("load",(()=>{window.dispatchEvent(new Event("scroll",{bubbles:!0,cancelable:!1})),document.querySelector("#afoxPageLoading")?.fadeOut((e=>e.remove())),document.querySelector("main.container")?.querySelectorAll("[exec-ajax]")?.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation();const r=e.getAttribute("exec-ajax"),c=r.substring(0,r.indexOf("&")).split(".");let o=e.getAttribute("success-url"),a=e.getAttribute("error-url");const n={module:c[0],act:c[1],...r.getQuery()};exec_ajax(n).then((e=>{o&&(o=o.split("#"),location.href=o[0],o[1]&&set_cookie("location.hash",o[1],1))})).catch((e=>{alert(e.message),a&&(location.href=a)}))}))}));const e=get_cookie("location.hash",!0);e&&(location.hash=e)}))})();