!function(e){"use strict";var t='<form action="%s" class="input-password" method="post" autocomplete="off"><div class="form-inline"><div>%s</div><input class="form-control" name="mb_password" type="password" placeholder="%s" style="width:150px" required> <button class="btn btn-primary" type="submit">%s</button> <button class="btn btn-default" type="button">%s</button></div></form>';e("[data-exec-act]").click(function(){var r={},a=e(this),s=a.attr("data-exec-act"),o=a.attr("data-act-param");if(!o)return!1;for(var n=0,i=(o=o.split(",")).length;n<i;n+=2)r[o[n]]=o[n+1];var d=a.closest("#bdReply"),c=a.closest(".reply-item"),l=a.attr("data-act-password")||"";d.find("form.right").remove().end().find(".reply-item>.right").show();var p=d.find('[data-exec-ajax="board.updateComment"]').clone().hide(),u=p.find(".af_editor_rp_content").afEditor();p.find(".form-group").show(),p.find('[disabled="disabled"]').removeAttr("disabled");var f=function(t,r,a){if("success"==t){e('<input type="hidden" name="rp_srl" value="">').prependTo(p);var s=c.find(">.right");return"0"===r.mb_srl&&(p.find(".area-mbinfo").find('[name="mb_nick"],[name="mb_password"]').attr("required","required").end().removeClass("hide"),p.find(".af-editor-toolbar,.af-editor-content>textarea,.af-editor-content>iframe").removeAttr("readonly")),p[0].dataImport(r),p.addClass("right").find(".close").show().click(function(){s.show("fast",function(){p.remove()})}).end().insertAfter(s.hide("slow")).show("slow"),p.find(".btn-success").removeClass("btn-success").addClass("btn-info"),2==r.rp_type&&u.switch(!0),c[0].scrollIntoView(!0),!1}};if("board.deleteComment"==s||"board.getComment"==s&&l){var m,_=encodeURIComponent(current_url.setQuery("rp",""));if(c.find(">>.inside_massage_box").length>0)return!1;l?"board.getComment"==s?(m=e(t.sprintf("",$_LANG.request_input.sprintf($_LANG.password),$_LANG.password,$_LANG.ok,$_LANG.close))).offOn("success.exec.ajax",function(t,r,a){t.preventDefault(),f("success",r),e(this).remove()}):m=e(t.sprintf("",$_LANG.confirm_select_delete.sprintf($_LANG.comment),$_LANG.password,$_LANG.ok,$_LANG.close)):m=e('<form action="%s" class="input-group" method="post" autocomplete="off"><div><div>%s</div><button class="btn btn-primary" type="submit">%s</button> <button class="btn btn-default" type="button">%s</button></div></form>'.sprintf("",$_LANG.confirm_select_delete.sprintf($_LANG.comment),$_LANG.yes,$_LANG.no)),m.offOn("error.exec.ajax",function(t,r,a){t.preventDefault(),e(t.currentTarget).find(">div>div").css("color","red").html($_LANG.error+": "+r.message),e(t.currentTarget).find('[name="mb_password"]').val("").focus()}).hide().addClass("inside_massage_box").prependTo(c.find(">.right")).fadeIn("slow"),m.find("button.btn-default").click(function(){m.fadeOut("slow",function(){e(this).remove()})}).focus(),m.attr("data-exec-ajax",s),m.prepend('<input type="hidden" name="rp_srl" value="'+r.rp_srl+'">'),m.prepend('<input type="hidden" name="success_return_url" value="'+_+'">'),m.addClass("inside_massage_box").prependTo(c.find(">.right")).fadeIn("slow",function(){var t=e(this).find('[name="mb_password"]');t.length>0&&t.focus()})}else"board.getComment"!=s&&"board.updateComment"!=s||("board.getComment"==s?exec_ajax(s,r,f):(u.switch(!1),e('<input type="hidden" name="rp_parent" value="">').prependTo(p),p[0].dataImport({rp_type:1,rp_secret:0,rp_content:"",rp_parent:r.rp_parent}),p.addClass("right").insertAfter(c.find(">.right")).show("slow")));return p.offOn("success.exec.ajax",function(e,t,r){e.preventDefault(),t.redirect_url&&parent.location.replace(t.redirect_url.setQuery("rp",t.rp_srl))}),!1}),e('[data-exec-ajax="board.updateDocument"],[data-exec-ajax="board.updateComment"]').on("success.exec.ajax",function(t,r,a){t.preventDefault();var s="board.updateDocument"==e(this).attr("data-exec-ajax");r.redirect_url&&parent.location.replace(r.redirect_url.setQuery(s?"srl":"rp",r[s?"wr_srl":"rp_srl"]))}),e(document).on("change.af.editor.toolbar",".af-editor-toolbar",function(t,r,a,s){var o=e(this).closest(".af-editor-group");"wr_type"!=r&&"rp_type"!=r||1!=o.length||o.data("af.editor").switch("2"===s)}),e('.list-table tr[data-hot-track], [href="#requirePassword"]').click(function(){var t=e(this);"TR"==t[0].tagName&&(t=t.find(".wr_title a"));var r=t.attr("href");if("#requirePassword"==r&&t.attr("data-param")){msg_box('<form action="%s" method="post" autocomplete="off"><p>%s</p><div class="form-group"><input type="password" class="form-control" name="mb_password" placeholder="%s" required /> <span class="sr-only">%s</span></div></form>'.sprintf(current_url,$_LANG.request_input.sprintf($_LANG.password),$_LANG.password,$_LANG.password),null,["question",["OK","cancel"]],function(e,r){if("ok"!=e)return!0;var a=r.find("form"),s=t.attr("data-srl")||"",o=(t.attr("data-param")||"").split(","),n=current_url;return s&&o.length>1&&(n=n.setQuery(o),a.offOn("submit",function(){if(a.data("check success"))return!0;var e={},t=["wr_srl"];return e.wr_srl=s,e.mb_password=a.find('input[name="mb_password"]').val(),exec_ajax("board.checkpassword",e,function(e,t,r){return a.data("check success","success"===e),"success"===e?(a.submit(),!1):"error"===e?(a.find(">p").html($_LANG.error+": "+t.message).css("color","red"),a.find('input[name="mb_password"]').val("").focus(),!1):void 0},t),!1}).attr("action",n).submit()),!1})}else location.href=r;return!1}),e(window).on("load",function(){var t=e("a.active[id^=reply_]");t.length>0?t[0].scrollIntoView(!0):e(this).trigger("scroll")}).on("scroll",function(){e("img[scroll-src]").each(function(){var t=e(this);t.offset().top<e(window).scrollTop()+e(window).height()+100&&(t.attr("src",t.attr("scroll-src")||"#"),t.removeAttr("scroll-src"))})})}(jQuery);